<div class="content-container">
    <div class="control-panel">
        <div class="filters">
            <input 
                type="text" 
                class="form-control" 
                placeholder="Buscar por placa..." 
                [(ngModel)]="busquedaPlaca"
                (keyup)="aplicarFiltros()"
            >
            <mat-form-field appearance="outline" class="filter-select">
                <mat-label>Tipo de Usuario</mat-label>
                <mat-select [(ngModel)]="tipoUsuarioFiltro" (selectionChange)="aplicarFiltros()">
                    <mat-option value="">Todos</mat-option>
                    <mat-option value="Residente">Residente</mat-option>
                    <mat-option value="Visitante">Visitante</mat-option>
                </mat-select>
            </mat-form-field>
            <button (click)="exportarPDF()" mat-flat-button color="primary" class="btn-export pdf-btn">
                <i class="fas fa-file-pdf"></i> Exportar PDF
            </button>
            <button (click)="exportarExcel()" mat-flat-button class="btn-export excel-btn">
                <i class="fas fa-file-excel"></i> Exportar Excel
            </button>
        </div>
    </div>

    @if (pestanaActiva === 'Auditoría') {
        <div class="data-table-wrapper mat-elevation-z8">
            <table mat-table [dataSource]="dataSource" class="audit-table">
                <ng-container matColumnDef="persona">
                    <th mat-header-cell *matHeaderCellDef>Nombre</th>
                    <td mat-cell *matCellDef="let row">{{row.persona}}</td>
                </ng-container>
                <ng-container matColumnDef="placa">
                    <th mat-header-cell *matHeaderCellDef>Placa</th>
                    <td mat-cell *matCellDef="let row">{{row.placa}}</td>
                </ng-container>
                <ng-container matColumnDef="horaAcceso">
                    <th mat-header-cell *matHeaderCellDef>Hora Acceso</th>
                    <td mat-cell *matCellDef="let row">{{row.horaAcceso}}</td>
                </ng-container>
                <ng-container matColumnDef="horaSalida">
                    <th mat-header-cell *matHeaderCellDef>Hora Salida</th>
                    <td mat-cell *matCellDef="let row">{{row.horaSalida}}</td>
                </ng-container>
                <ng-container matColumnDef="tipoUsuario">
                    <th mat-header-cell *matHeaderCellDef>Tipo Usuario</th>
                    <td mat-cell *matCellDef="let row">{{row.tipoUsuario}}</td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="columnas"></tr>
                <tr mat-row *matRowDef="let row; columns: columnas;"></tr>
                <tr class="mat-row" *matNoDataRow>
                  <td class="mat-cell" [attr.colspan]="columnas.length">
                      No se encontraron registros de auditoría que coincidan con los filtros.
                  </td>
                </tr>
            </table>
        </div>
        
        <div class="table-footer">
            Total Registros: {{ dataSource.filteredData.length }}
            @if (dataSource.filteredData.length !== datosTabla.length) {
                <span> (Filtrados de {{ datosTabla.length }})</span>
            }
        </div>
    } @else {
        <div class="placeholder-content">
            <h2>Contenido de {{ pestanaActiva }} no disponible.</h2>
            <p>Aquí se mostraría la información de trazabilidad o logs de {{ pestanaActiva }}.</p>
        </div>
    }
</div>